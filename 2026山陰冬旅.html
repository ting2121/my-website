<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="theme-color" content="#1e293b">
    <title>2026 å±±é™°å†¬æ—…</title>
    
    <!-- å¼•å…¥ React å’Œ Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- å¼•å…¥ Icon åº« (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* éš±è—æ²è»¸ä½†ä¿æŒåŠŸèƒ½ */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* é˜²æ­¢ iOS æ©¡çš®ç­‹æ•ˆæœ */
        body {
            overscroll-behavior-y: none;
            -webkit-tap-highlight-color: transparent;
        }
        /* é£„é›ªå‹•ç•« */
        @keyframes snow {
            0% { transform: translateY(-10px); opacity: 0; }
            20% { opacity: 1; }
            100% { transform: translateY(100vh); opacity: 0; }
        }
        .snowflake {
            position: absolute;
            top: -10px;
            color: rgba(255, 255, 255, 0.4);
            animation: snow 10s linear infinite;
            pointer-events: none;
        }
        /* å®‰å…¨å€åŸŸè¨­å®š (é‡å° iPhoneç€æµ·) */
        .pb-safe {
            padding-bottom: env(safe-area-inset-bottom);
        }
    </style>
</head>
<body class="bg-[#fdfbf7] text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // ç‚ºäº†åœ¨ HTML ä¸­ä½¿ç”¨ Lucide Iconsï¼Œæˆ‘å€‘å‰µå»ºä¸€å€‹ç°¡å–®çš„æ˜ å°„çµ„ä»¶
        const Icon = ({ name, size = 24, className }) => {
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} width={size} height={size} className={className}></i>;
        };

        const TravelPlanner = () => {
            // å®šç¾©æ—¥æœŸç¯„åœ (2026/1/22 - 1/26)
            const dates = [
                { date: '2026-01-22', label: 'åˆå››', fullDate: '1æœˆ22æ—¥ (å››)', theme: 'æŠµé”' },
                { date: '2026-01-23', label: 'åˆäº”', fullDate: '1æœˆ23æ—¥ (äº”)', theme: 'é³¥å–' },
                { date: '2026-01-24', label: 'åˆå…­', fullDate: '1æœˆ24æ—¥ (å…­)', theme: 'å³¶æ ¹' },
                { date: '2026-01-25', label: 'åˆä¸ƒ', fullDate: '1æœˆ25æ—¥ (æ—¥)', theme: 'æº«æ³‰' },
                { date: '2026-01-26', label: 'åˆå…«', fullDate: '1æœˆ26æ—¥ (ä¸€)', theme: 'è¿”ç¨‹' },
            ];

            const [activeDate, setActiveDate] = useState(dates[0].date);
            const [showInstallGuide, setShowInstallGuide] = useState(false);
            
            // é è¨­è¡Œç¨‹
            const initialItinerary = {
                '2026-01-22': [
                    { id: 1, time: '14:30', activity: 'æŠµé”ç±³å­é¬¼å¤ªéƒæ©Ÿå ´', location: 'ç±³å­å¸‚', type: 'transport' }
                ],
                '2026-01-23': [
                    { id: 2, time: '09:00', activity: 'é³¥å–ç ‚ä¸˜ (å†¬ä¹‹é›ªæ™¯)', location: 'é³¥å–å¸‚', type: 'sightseeing' },
                    { id: 3, time: '12:00', activity: 'å“åšæ¾è‘‰èŸ¹å¤§é¤', location: 'è³€éœ²æ¸¯', type: 'food' }
                ],
                '2026-01-24': [
                    { id: 4, time: '10:00', activity: 'å‡ºé›²å¤§ç¤¾ åƒæ‹œçµç·£', location: 'å‡ºé›²å¸‚', type: 'sightseeing' }
                ],
                '2026-01-25': [],
                '2026-01-26': [
                    { id: 5, time: '11:00', activity: 'è³¼è²·ä¼´æ‰‹ç¦® (ç™½å…”é¥…é ­)', location: 'è»Šç«™', type: 'shopping' }
                ],
            };

            const [itinerary, setItinerary] = useState(() => {
                const saved = localStorage.getItem('myTrip2026_Sanin_V2');
                return saved ? JSON.parse(saved) : initialItinerary;
            });

            const [newTime, setNewTime] = useState('');
            const [newActivity, setNewActivity] = useState('');
            const [newLocation, setNewLocation] = useState('');

            useEffect(() => {
                localStorage.setItem('myTrip2026_Sanin_V2', JSON.stringify(itinerary));
                lucide.createIcons(); // ç¢ºä¿åœ–æ¨™åœ¨æ¸²æŸ“å¾Œæ›´æ–°
            }, [itinerary, activeDate]);

            const handleAddActivity = () => {
                if (!newActivity) return alert('è«‹è¼¸å…¥è¡Œç¨‹å…§å®¹');
                
                const newItem = {
                    id: Date.now(),
                    time: newTime || 'å¾…å®š',
                    activity: newActivity,
                    location: newLocation,
                    type: 'general' 
                };

                setItinerary(prev => {
                    const currentList = prev[activeDate] || [];
                    const updatedList = [...currentList, newItem].sort((a, b) => a.time.localeCompare(b.time));
                    return { ...prev, [activeDate]: updatedList };
                });

                setNewTime('');
                setNewActivity('');
                setNewLocation('');
            };

            const handleDeleteActivity = (id) => {
                if(!window.confirm('ç¢ºå®šè¦åˆªé™¤å—ï¼Ÿ')) return;
                setItinerary(prev => ({
                    ...prev,
                    [activeDate]: prev[activeDate].filter(item => item.id !== id)
                }));
            };

            const handleExport = () => {
                let content = "â„ï¸ 2026 å±±é™°å†¬æ—¥ä¹‹æ—… (1/22 - 1/26)\n\n";
                dates.forEach(d => {
                    content += `ğŸ“… ${d.fullDate} ã€${d.label}ã€‘\n`;
                    const items = itinerary[d.date] || [];
                    if (items.length === 0) content += "   (æœ¬æ—¥è‡ªç”±æ¢ç´¢)\n";
                    else {
                        items.forEach(item => {
                            content += `   â— ${item.time} | ${item.activity}`;
                            if (item.location) content += ` (@${item.location})`;
                            content += "\n";
                        });
                    }
                    content += "\n-----------------------------------\n\n";
                });

                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = '2026_å±±é™°ä¹‹æ—….txt';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            const currentDayInfo = dates.find(d => d.date === activeDate);

            // æ ¹æ“šæ´»å‹•é¡å‹é¸æ“‡åœ–æ¨™åç¨±
            const getIconName = (text) => {
                if (text.includes('åƒ') || text.includes('é¤') || text.includes('èŸ¹') || text.includes('ç‰›')) return 'utensils';
                if (text.includes('è»Š') || text.includes('æ©Ÿ') || text.includes('ç§»å‹•')) return 'train-front';
                if (text.includes('æ‹') || text.includes('æ™¯') || text.includes('ç¤¾')) return 'camera';
                return 'sparkles';
            };

            return (
                <div className="min-h-screen flex flex-col font-sans relative selection:bg-rose-200 pb-safe">
                    
                    {/* Header */}
                    <header className="relative bg-gradient-to-b from-[#1e293b] to-[#334155] text-white pt-10 pb-12 px-6 shadow-lg overflow-hidden shrink-0">
                        <div className="absolute top-0 left-0 w-full h-full opacity-10 bg-[radial-gradient(circle_at_top_right,_var(--tw-gradient-stops))] from-white to-transparent"></div>
                        
                        {/* é£„é›ª */}
                        {[...Array(6)].map((_, i) => (
                            <div key={i} className="snowflake" style={{ 
                                left: `${Math.random() * 100}%`, 
                                animationDuration: `${5 + Math.random() * 5}s`, 
                                animationDelay: `${Math.random() * 5}s`,
                                fontSize: `${10 + Math.random() * 20}px`
                            }}>â„</div>
                        ))}

                        <div className="relative max-w-2xl mx-auto flex justify-between items-end">
                            <div>
                                <div className="flex items-center gap-2 text-rose-300 font-medium text-sm tracking-widest mb-1">
                                    <Icon name="snowflake" size={14} /> WINTER JOURNEY
                                </div>
                                <h1 className="text-3xl font-bold tracking-wide font-serif">å±±é™°å†¬æ—…</h1>
                                <p className="text-slate-300 text-xs mt-2 font-light">2026.01.22 â€” 01.26</p>
                            </div>
                            <div className="flex gap-2">
                                <button 
                                    onClick={() => setShowInstallGuide(true)}
                                    className="bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 p-2 rounded-full transition"
                                >
                                    <Icon name="download" size={16} />
                                </button>
                                <button 
                                    onClick={handleExport}
                                    className="bg-white/10 hover:bg-white/20 backdrop-blur-sm border border-white/20 px-4 py-2 rounded-full text-xs transition flex items-center gap-2 group"
                                >
                                    <span>åŒ¯å‡º</span>
                                </button>
                            </div>
                        </div>
                    </header>

                    {/* Date Tabs */}
                    <div className="sticky top-0 z-20 bg-[#fdfbf7]/95 backdrop-blur-sm pt-4 pb-2 shadow-sm">
                        <div className="max-w-2xl mx-auto px-4 overflow-x-auto no-scrollbar">
                            <div className="flex gap-3 min-w-max pb-2">
                                {dates.map((d) => {
                                    const isActive = activeDate === d.date;
                                    return (
                                        <button
                                            key={d.date}
                                            onClick={() => setActiveDate(d.date)}
                                            className={`relative flex flex-col items-center justify-center px-4 py-3 rounded-xl transition-all duration-300 border ${
                                                isActive
                                                    ? 'bg-[#be123c] text-white border-[#be123c] shadow-lg shadow-rose-900/20 translate-y-[-2px]'
                                                    : 'bg-white text-slate-500 border-slate-200 hover:border-slate-300 hover:bg-slate-50'
                                            }`}
                                        >
                                            <span className={`text-[10px] tracking-wider mb-1 ${isActive ? 'text-rose-100' : 'text-slate-400'}`}>
                                                {d.label}
                                            </span>
                                            <span className="text-sm font-bold font-serif whitespace-nowrap">
                                                {d.date.split('-')[2]} <span className="text-xs font-normal opacity-80">æ—¥</span>
                                            </span>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="flex-1 px-4 py-6 max-w-2xl mx-auto w-full pb-36">
                        <div className="flex items-center gap-3 mb-6">
                            <div className="h-8 w-1 bg-[#be123c] rounded-full"></div>
                            <div>
                                <h2 className="text-xl font-bold text-slate-800 font-serif">{currentDayInfo.fullDate}</h2>
                                <p className="text-xs text-slate-500 tracking-wide mt-0.5">ä»Šæ—¥ä¸»é¡Œï¼š{currentDayInfo.theme}</p>
                            </div>
                        </div>

                        <div className="space-y-4">
                            {(itinerary[activeDate] || []).length === 0 ? (
                                <div className="flex flex-col items-center justify-center py-16 text-slate-400 border-2 border-dashed border-slate-200 rounded-2xl bg-white/50">
                                    <div className="mb-4 opacity-20"><Icon name="snowflake" size={48} /></div>
                                    <p className="text-sm font-light">å†¬æ—¥éœå¥½ï¼Œæš«ç„¡è¡Œç¨‹</p>
                                    <p className="text-xs opacity-60 mt-1">é»æ“Šä¸‹æ–¹æŒ‰éˆ•è¦åŠƒæ—…é€”</p>
                                </div>
                            ) : (
                                (itinerary[activeDate] || []).map((item) => (
                                    <div key={item.id} className="group relative bg-white p-5 rounded-2xl shadow-sm border border-slate-100 hover:shadow-md transition-all duration-300 flex gap-4 overflow-hidden">
                                        <div className="absolute left-0 top-0 bottom-0 w-1 bg-gradient-to-b from-indigo-900 to-indigo-700"></div>
                                        <div className="flex flex-col items-center pt-1 min-w-[3.5rem]">
                                            <span className="text-lg font-bold text-indigo-900 font-mono tracking-tighter">{item.time}</span>
                                            <div className="h-full w-px bg-slate-100 my-2 relative">
                                                <div className="absolute bottom-0 left-1/2 -translate-x-1/2 w-1.5 h-1.5 rounded-full bg-slate-200"></div>
                                            </div>
                                        </div>
                                        <div className="flex-1 pb-1 z-10">
                                            <h3 className="text-base font-bold text-slate-800 mb-1 leading-tight">{item.activity}</h3>
                                            {item.location && (
                                                <div className="flex items-center gap-1.5 text-xs text-slate-500 font-medium mt-2 bg-slate-50 inline-flex px-2 py-1 rounded-md">
                                                    <Icon name="map-pin" size={12} className="text-rose-600" />
                                                    {item.location}
                                                </div>
                                            )}
                                        </div>
                                        <div className="absolute right-4 bottom-4 opacity-10 text-indigo-900 pointer-events-none transform rotate-12 scale-150">
                                            <Icon name={getIconName(item.activity + item.location)} size={48} />
                                        </div>
                                        <button onClick={() => handleDeleteActivity(item.id)} className="absolute top-3 right-3 text-slate-300 hover:text-rose-600 p-2 z-20">
                                            <Icon name="trash-2" size={16} />
                                        </button>
                                    </div>
                                ))
                            )}
                        </div>
                    </main>

                    {/* Input Area */}
                    <div className="fixed bottom-6 left-4 right-4 z-30">
                        <div className="max-w-2xl mx-auto bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-slate-100 p-1">
                            <div className="flex flex-col gap-2 p-3">
                                <div className="flex gap-2">
                                    <div className="relative w-[35%]">
                                        <input type="time" value={newTime} onChange={(e) => setNewTime(e.target.value)} className="w-full pl-3 pr-2 py-2.5 bg-slate-50 hover:bg-white border-0 rounded-xl text-sm font-mono text-center focus:ring-2 focus:ring-indigo-500 transition-all text-slate-600 font-bold" />
                                    </div>
                                    <div className="relative flex-1">
                                        <input type="text" placeholder="æ´»å‹•å…§å®¹..." value={newActivity} onChange={(e) => setNewActivity(e.target.value)} className="w-full px-4 py-2.5 bg-slate-50 hover:bg-white border-0 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 transition-all placeholder:text-slate-400" />
                                    </div>
                                </div>
                                <div className="flex gap-2 items-center">
                                    <div className="relative flex-1 group">
                                        <div className="absolute left-3 top-2.5 text-slate-400"><Icon name="map-pin" size={16} /></div>
                                        <input type="text" placeholder="åœ°é» (é¸å¡«)" value={newLocation} onChange={(e) => setNewLocation(e.target.value)} className="w-full pl-9 pr-3 py-2.5 bg-slate-50 hover:bg-white border-0 rounded-xl text-sm focus:ring-2 focus:ring-indigo-500 transition-all placeholder:text-slate-400" />
                                    </div>
                                    <button onClick={handleAddActivity} className="bg-[#be123c] text-white w-12 h-10 rounded-xl flex items-center justify-center hover:bg-rose-700 active:scale-95 transition shadow-lg shadow-rose-900/20">
                                        <Icon name="plus" size={24} />
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* å®‰è£æŒ‡å— Modal */}
                    {showInstallGuide && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-slate-800 mb-4 flex items-center gap-2">
                                    <Icon name="smartphone" className="text-indigo-600" /> å¦‚ä½•å®‰è£ App
                                </h3>
                                <div className="space-y-4 text-sm text-slate-600">
                                    <div className="bg-slate-50 p-3 rounded-lg">
                                        <p className="font-bold text-indigo-900 mb-1">å¦‚æœæ˜¯ iOS (iPhone):</p>
                                        <ol className="list-decimal list-inside space-y-1">
                                            <li>ç”¨ Safari é–‹å•Ÿæ­¤æª”æ¡ˆ</li>
                                            <li>é»æ“Šä¸‹æ–¹ã€Œåˆ†äº«ã€åœ–ç¤º <Icon name="share" size={12} className="inline" /></li>
                                            <li>é¸æ“‡ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</li>
                                        </ol>
                                    </div>
                                    <div className="bg-slate-50 p-3 rounded-lg">
                                        <p className="font-bold text-indigo-900 mb-1">å¦‚æœæ˜¯ Android:</p>
                                        <ol className="list-decimal list-inside space-y-1">
                                            <li>ç”¨ Chrome é–‹å•Ÿæ­¤æª”æ¡ˆ</li>
                                            <li>é»æ“Šå³ä¸Šè§’é¸å–® <Icon name="more-vertical" size={12} className="inline" /></li>
                                            <li>é¸æ“‡ã€Œå®‰è£æ‡‰ç”¨ç¨‹å¼ã€æˆ–ã€ŒåŠ åˆ°ä¸»ç•«é¢ã€</li>
                                        </ol>
                                    </div>
                                </div>
                                <button onClick={() => setShowInstallGuide(false)} className="mt-6 w-full bg-slate-800 text-white py-3 rounded-xl font-bold hover:bg-slate-700">
                                    æˆ‘çŸ¥é“äº†
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TravelPlanner />);
    </script>
</body>
</html>